[main_keras.py::train] Number of classes: 1
[main_keras.py::train] Model created with input size: (128, 256)

--- [main_keras.py::data_generator] DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::data_generator] Sample shape: (128, 256, 3)
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Shapes from dataset: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::data_generator] Shapes dtype: float32
[main_keras.py::data_generator] Shapes shape: (3, 2)
[main_keras.py::data_generator] Original size: [0.0, 0.0]
[main_keras.py::data_generator] Ratio/Padding: [0.0, 0.0]
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.28900102 0.3226512  0.1240098  0.25661054]]

--- [main_keras.py::data_generator] DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::data_generator] Sample shape: (128, 256, 3)
[main_keras.py::data_generator] Target shape: (0, 6)
[main_keras.py::data_generator] Shapes from dataset: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::data_generator] Shapes dtype: float32
[main_keras.py::data_generator] Shapes shape: (3, 2)
[main_keras.py::data_generator] Original size: [0.0, 0.0]
[main_keras.py::data_generator] Ratio/Padding: [0.0, 0.0]
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.49781036 0.6286972  0.06627086 0.14034379]
 [0.         0.         0.9233814  0.60004216 0.05376375 0.10190058]]
[main_keras.py::data_generator] Batch samples shape: (4, 128, 256, 3)
[main_keras.py::data_generator] Batch targets shape: (3, 6)
[main_keras.py::data_generator] Batch shapes shape: (4, 3, 2)

--- [main_keras.py::train] KERAS BATCH 0 DEBUG ---
[main_keras.py::train] Samples shape: (4, 128, 256, 3)
[main_keras.py::train] Samples dtype: <dtype: 'float32'>
[main_keras.py::train] Samples min/max: 0.000/0.886
[main_keras.py::train] Targets shape: (3, 6)
[main_keras.py::train] Targets dtype: <dtype: 'float32'>
[main_keras.py::train] Number of targets: 3
[main_keras.py::train] Shapes: [[[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]]
[main_keras.py::train] Shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
[main_keras.py::train] Shapes dtype: <dtype: 'float32'>
[main_keras.py::train] Shapes shape: (4, 3, 2)
[main_keras.py::train] Batch item 0 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 0 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 0 ratio/padding: [0.0, 0.0]
[main_keras.py::train] Batch item 1 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 1 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 1 ratio/padding: [0.0, 0.0]

--- [main_keras.py::train] KERAS MODEL OUTPUT DEBUG ---
[main_keras.py::train] Output shape: (4, 16, 32, 65)
[main_keras.py::train] Output min/max: -5.489851/6.603584
[main_keras.py::train] Output mean/std: -0.063585/0.658547

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.179394
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.736091, max: 0.172809
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.1728086918592453
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.0633229723898694e-05
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 36
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 14.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.2122888565063477
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (14, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (14, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (14, 1), h: (14, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (14, 1), h: (14, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (14, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (14, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (14, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.044060, max: 0.179394
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (14, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (14, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (14, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (14, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.033258, max: 0.172809
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (56, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (56,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (14, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.710617
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 623.666199
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 6.339065
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 4.114934
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 1.212289
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 14.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 623.666199
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 6.339065
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 4.114934
[utils/util.py::ComputeLoss.__call__] Total loss: 634.120178
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [main_keras.py::train] KERAS LOSS DEBUG ---
[main_keras.py::train] Loss value: 634.120178
[main_keras.py::train] Loss dtype: <dtype: 'float32'>

--- [main_keras.py::train] KERAS BATCH 1 DEBUG ---
[main_keras.py::train] Samples shape: (4, 128, 256, 3)
[main_keras.py::train] Samples dtype: <dtype: 'float32'>
[main_keras.py::train] Samples min/max: 0.188/0.847
[main_keras.py::train] Targets shape: (0, 6)
[main_keras.py::train] Targets dtype: <dtype: 'float32'>
[main_keras.py::train] Number of targets: 0
[main_keras.py::train] Shapes: [[[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]]
[main_keras.py::train] Shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
[main_keras.py::train] Shapes dtype: <dtype: 'float32'>
[main_keras.py::train] Shapes shape: (4, 3, 2)
[main_keras.py::train] Batch item 0 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 0 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 0 ratio/padding: [0.0, 0.0]
[main_keras.py::train] Batch item 1 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 1 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 1 ratio/padding: [0.0, 0.0]

--- [main_keras.py::train] KERAS MODEL OUTPUT DEBUG ---
[main_keras.py::train] Output shape: (4, 16, 32, 65)
[main_keras.py::train] Output min/max: -12572.098633/29.482172
[main_keras.py::train] Output mean/std: -79.409462/669.741821

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (0, 6)
[utils/util.py::ComputeLoss.__call__] No targets - gt shape: (4, 0, 5)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 0, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 0, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 0, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 0
[utils/util.py::ComputeLoss.assign] No ground truth boxes, returning zeros

--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [main_keras.py::train] KERAS LOSS DEBUG ---
[main_keras.py::train] Loss value: 0.000000
[main_keras.py::train] Loss dtype: <dtype: 'float32'>

--- [main_keras.py::train] KERAS BATCH 2 DEBUG ---
[main_keras.py::train] Samples shape: (4, 128, 256, 3)
[main_keras.py::train] Samples dtype: <dtype: 'float32'>
[main_keras.py::train] Samples min/max: 0.000/1.000
[main_keras.py::train] Targets shape: (4, 6)
[main_keras.py::train] Targets dtype: <dtype: 'float32'>
[main_keras.py::train] Number of targets: 4
[main_keras.py::train] Shapes: [[[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]]
[main_keras.py::train] Shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
[main_keras.py::train] Shapes dtype: <dtype: 'float32'>
[main_keras.py::train] Shapes shape: (4, 3, 2)
[main_keras.py::train] Batch item 0 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 0 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 0 ratio/padding: [0.0, 0.0]
[main_keras.py::train] Batch item 1 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 1 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 1 ratio/padding: [0.0, 0.0]

--- [main_keras.py::train] KERAS MODEL OUTPUT DEBUG ---
[main_keras.py::train] Output shape: (4, 16, 32, 65)
[main_keras.py::train] Output min/max: -25415.291016/42.472538
[main_keras.py::train] Output mean/std: -145.020935/1219.747314

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.307445
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.243088, max: 0.293952
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.293952077627182
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 48
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [main_keras.py::train] KERAS LOSS DEBUG ---
[main_keras.py::train] Loss value: 0.000000
[main_keras.py::train] Loss dtype: <dtype: 'float32'>

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.350400
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.256617, max: 0.346297
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3462967872619629
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 64
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 9.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (9, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (9, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (9, 1), h: (9, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (9, 1), h: (9, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (9, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (9, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.028200, max: 0.318976
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (9, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (9, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.157874, max: 0.232655
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (36, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (36,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (9, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 9.521558
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 9.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.216076
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.355718, max: 0.213975
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.21397460997104645
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 53
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.009717, max: 0.017781
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.187784, max: -0.140088
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (12, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (12,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (3, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 7.468507
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.246628
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.281901, max: 0.232960
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.23296044766902924
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 64
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.237072
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.326743, max: 0.200255
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.20025545358657837
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 28
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.442791
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.351887, max: 0.418056
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4180561900138855
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 63
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.331905
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.290338, max: 0.265069
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.26506900787353516
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 39
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.338306
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.344647, max: 0.295696
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2956961989402771
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 51
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 9.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (9, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (9, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (9, 1), h: (9, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (9, 1), h: (9, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (9, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (9, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.046917, max: 0.199936
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (9, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (9, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.138932, max: 0.165932
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (36, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (36,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (9, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 14.659040
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 9.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.198218
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.381450, max: 0.189550
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.18955017626285553
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 26
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.296819
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.339653, max: 0.286410
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2864099144935608
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 45
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (2, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 2
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 2)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 2, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 2, 1, 1), h: (4, 2, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.000000
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.362986, max: -0.098573
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 0
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (12, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 12, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 12, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 12, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 12
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 12)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 12, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 12, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 12, 1, 1), h: (4, 12, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 12, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 12, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 12, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.201852
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 12, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 12, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 12, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 12, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.361259, max: 0.190880
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 12, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.19087986648082733
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 12, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 12, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 37
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 12, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 12, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 12, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 12, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 12, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 12, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 12, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.631554
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.330822, max: 0.625426
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.6254258751869202
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 25
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.016905, max: 0.023676
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.044719, max: 0.021970
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (12, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (12,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (3, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 11.963529
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.364091
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.334067, max: 0.328917
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3289165198802948
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 54
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.747361
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.362518, max: 0.744858
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.7448582053184509
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 21
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.330071
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.294895, max: 0.312426
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.31242573261260986
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 25
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.256613
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.371763, max: 0.254190
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.25418975949287415
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 24
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.000000
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.325363, max: -0.219717
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 0
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.275681
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.332168, max: 0.264214
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.26421356201171875
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 28
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.280511
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.433805, max: 0.277326
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.27732646465301514
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 8
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.327854
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.292584, max: 0.283112
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.28311192989349365
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 77
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.477479
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.361598, max: 0.461790
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4617895781993866
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 24
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.408427
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.325481, max: 0.388735
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3887345790863037
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 62
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.542399
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.328907, max: 0.541103
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5411025285720825
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 44
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.268469
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.335260, max: 0.222049
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.22204948961734772
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 23
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.123169
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.362973, max: 0.118919
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.1189194992184639
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 10
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.065666, max: 0.065666
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.203294, max: -0.203294
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 12.865528
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (2, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 2
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 2)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 2, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 2, 1, 1), h: (4, 2, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.215592
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.303838, max: 0.135514
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.13551396131515503
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 0
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.266613
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.269596, max: 0.257953
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.25795280933380127
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 32
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.269906
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.293821, max: 0.264946
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.26494595408439636
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 51
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.499506
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.335648, max: 0.480767
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.48076677322387695
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 10
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.771678
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.149860, max: 0.768562
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.7685616612434387
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 44
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.255613
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.336550, max: 0.247283
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.24728305637836456
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 49
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.354967
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.383336, max: 0.307752
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3077523112297058
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 14
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (2, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 2
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 2)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 2, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 2, 1, 1), h: (4, 2, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.314745
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.393506, max: 0.288474
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.28847411274909973
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 21
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.294584
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.321319, max: 0.246049
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2460494041442871
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 32
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.852048
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.327020, max: 0.849366
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.849366307258606
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 70
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.347212
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.335142, max: 0.328601
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.32860106229782104
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 27
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.123659
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.348227, max: 0.098352
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.0983518585562706
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 14
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.295082
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.370685, max: 0.272308
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2723076045513153
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 24
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.541296
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.355235, max: 0.531616
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.531615674495697
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 66
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.217609
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.367407, max: 0.207116
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2071162909269333
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 38
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 7.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (7, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (7, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (7, 1), h: (7, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (7, 1), h: (7, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (7, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (7, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (7, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.083111, max: 0.141157
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (7, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (7, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (7, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (7, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.101311, max: 0.072983
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (28, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (28,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (7, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 17.549526
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 7.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 2) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 3) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 4) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (4, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (4, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
Precision: 0.000, Recall: 0.000, mAP50: 0.000, mAP: 0.000

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 2) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 3) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 4) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508

=== DEBUG: visualize_predictions input shapes (vis_count=0) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.322/0.749
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (300, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: 0.000000/253.928421
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[ 0.        0.       18.       17.31     24.       23.380001]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=1) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.341/0.761
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (300, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: -0.228622/253.305069
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       245.35      19.5       21.289993  23.      ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=2) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.396/0.792
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (300, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: 0.000000/254.206482
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       127.97      43.38      26.070007  27.54    ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=3) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.227/0.800
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (300, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: -0.449277/253.225281
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       243.62      25.5       22.440002  23.      ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=4) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.027/0.749
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (300, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: 0.000000/252.000000
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       235.        44.67      20.669998  21.330002]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (1, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (1, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
Precision: 0.000, Recall: 0.000, mAP50: 0.000, mAP: 0.000

--- [main_keras.py::data_generator] DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::data_generator] Sample shape: (128, 256, 3)
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Shapes from dataset: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::data_generator] Shapes dtype: float32
[main_keras.py::data_generator] Shapes shape: (3, 2)
[main_keras.py::data_generator] Original size: [0.0, 0.0]
[main_keras.py::data_generator] Ratio/Padding: [0.0, 0.0]
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.5345773  0.36015588 0.08023334 0.15295792]
 [0.         0.         0.7200736  0.39818674 0.08471781 0.16025814]]

--- [main_keras.py::data_generator] DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::data_generator] Sample shape: (128, 256, 3)
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Shapes from dataset: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::data_generator] Shapes dtype: float32
[main_keras.py::data_generator] Shapes shape: (3, 2)
[main_keras.py::data_generator] Original size: [0.0, 0.0]
[main_keras.py::data_generator] Ratio/Padding: [0.0, 0.0]
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.36559916 0.8191873  0.12068337 0.24755567]]
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.9612294  0.31355157 0.07754128 0.18258691]
 [0.         0.         0.4003271  0.9654275  0.07300133 0.06912929]]
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.16764522 0.5929122  0.10840154 0.20395833]]
[main_keras.py::data_generator] Batch samples shape: (4, 128, 256, 3)
[main_keras.py::data_generator] Batch targets shape: (6, 6)
[main_keras.py::data_generator] Batch shapes shape: (4, 3, 2)
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.7806764  0.72839105 0.12021692 0.25567204]]

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.405129
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.384445, max: 0.402676
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.40267613530158997
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 57
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.690250
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.167614, max: 0.686384
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.6863841414451599
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 40
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.408204
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.299131, max: 0.396265
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3962654769420624
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 75
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.414159
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.351273, max: 0.396728
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.396727591753006
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 52
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.407224
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.353896, max: 0.396553
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3965532183647156
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 50
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.266259
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.244122, max: 0.247702
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.24770236015319824
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 20
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.399148
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.277186, max: 0.390307
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3903069794178009
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 55
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.528983
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.362301, max: 0.523041
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5230411887168884
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 61
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.438526
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.431328, max: 0.399230
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.39922985434532166
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 33
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.454322
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.131236, max: 0.446451
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4464513063430786
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 37
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.262101
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.355662, max: 0.249579
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.24957923591136932
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 39
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.183780
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.344026, max: 0.123948
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.12394800782203674
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 35
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.016166, max: 0.016166
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.242753, max: -0.242753
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 11.183836
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.407338
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.363554, max: 0.405943
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4059430658817291
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 59
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.531691
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.351715, max: 0.522484
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5224839448928833
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 48
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.322111
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.319580, max: 0.313128
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3131275475025177
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 47
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (10, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 10, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 10, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 10, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 10
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 10)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 10, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 10, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 10, 1, 1), h: (4, 10, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.399918
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.440111, max: 0.377468
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3774678111076355
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 50
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 10, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 10, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 10, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (2, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 2
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 2)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 2, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 2, 1, 1), h: (4, 2, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.000000
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.331137, max: -0.108454
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 0
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.588258
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.176307, max: 0.576784
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5767844319343567
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 36
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.175021
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.352421, max: 0.169333
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.16933254897594452
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 4
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.247189
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.437166, max: 0.240934
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.24093368649482727
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 20
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.055806, max: 0.126469
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.128123, max: -0.011395
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (12, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (12,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (3, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 10.169066
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.236012
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.399147, max: 0.210610
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.21061046421527863
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.563565
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.363645, max: 0.545491
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5454908609390259
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 38
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000002, max: 0.229819
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.122158, max: 0.196612
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (32, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (32,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (8, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 16.364731
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.556123
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.175235, max: 0.548442
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5484416484832764
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 18
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.272619
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.349672, max: 0.252813
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2528134286403656
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 60
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.186485
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.368545, max: 0.174967
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.17496727406978607
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 20
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.369426
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.366527, max: 0.330476
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3304756283760071
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 60
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.330844
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.387203, max: 0.298687
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2986873686313629
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 16
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (1, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 1, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 1, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 1, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 1
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 1)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 1, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 1, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 1, 1, 1), h: (4, 1, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.000000
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.343711, max: -0.078366
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 0
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 1, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 1, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 1, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.357335
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.364051, max: 0.354074
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.35407355427742004
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 40
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.229172
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.305080, max: 0.208398
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.20839841663837433
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 14
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.550831
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.386617, max: 0.516550
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5165503025054932
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 18
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.440588
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.353585, max: 0.414191
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4141908288002014
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 46
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.283142
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.291996, max: 0.274225
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2742253839969635
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 66
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.000000
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.334978, max: -0.004784
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 0
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.222680
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.355223, max: 0.213692
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.21369227766990662
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 37
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.410609
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.365128, max: 0.409804
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4098040461540222
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 56
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.270693
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.308482, max: 0.258244
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.25824442505836487
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 45
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.157082
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.323770, max: 0.133686
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.1336859166622162
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 6
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.239887
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.315905, max: 0.225883
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.225883349776268
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 29
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 5.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (5, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (5, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (5, 1), h: (5, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (5, 1), h: (5, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (5, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (5, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (5, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.078198, max: 0.160868
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (5, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (5, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (5, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (5, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.107753, max: 0.098203
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (20, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (20,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (5, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 10.715925
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 5.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.494859
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.331277, max: 0.477362
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.47736191749572754
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 12
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.363399
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.308045, max: 0.345721
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.34572088718414307
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 48
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.209786
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.311534, max: 0.202313
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.20231260359287262
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 12
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.121817, max: 0.184994
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.063533, max: 0.105574
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (16, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (16,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (4, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 9.855442
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.361834
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.341161, max: 0.335994
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.33599433302879333
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 20
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 2) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 3) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 4) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (4, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (4, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
Precision: 0.000, Recall: 0.000, mAP50: 0.000, mAP: 0.000

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 2) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 3) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 4) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508

=== DEBUG: visualize_predictions input shapes (vis_count=0) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.322/0.749
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (247, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: -4.908001/252.996979
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[ 0.        0.       18.       17.31     24.       23.380001]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=1) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.341/0.761
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (172, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: -4.653446/252.000000
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       245.35      19.5       21.289993  23.      ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=2) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.396/0.792
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (165, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: -2.000716/252.000015
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       127.97      43.38      26.070007  27.54    ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=3) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.227/0.800
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (168, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: -2.051696/252.000000
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       243.62      25.5       22.440002  23.      ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=4) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.027/0.749
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (270, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0] min/max: -4.896563/252.000000
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       235.        44.67      20.669998  21.330002]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
[main_keras.py::test] Model outputs shape: (1, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (1, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 508
Precision: 0.000, Recall: 0.000, mAP50: 0.000, mAP: 0.000
