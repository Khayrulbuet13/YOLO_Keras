[main_keras.py::train] Number of classes: 1
[nets/tinysimov35_keras.initialize_biases] Box bias initialized
[nets/tinysimov35_keras.initialize_biases] Cls bias initialized
[nets/tinysimov35_keras.YOLO.__init__] Box bias mean: 1.0
[nets/tinysimov35_keras.YOLO.__init__] Cls bias mean: -7.15461540222168
[nets/tinysimov35_keras.YOLO.__init__] Initial logits min/max: 0.0000/252.0000
[main_keras.py::train] Model created with input size: (128, 256)

--- [main_keras.py::data_generator] DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::data_generator] Sample shape: (128, 256, 3)
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Shapes from dataset: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::data_generator] Shapes dtype: float32
[main_keras.py::data_generator] Shapes shape: (3, 2)
[main_keras.py::data_generator] Original size: [0.0, 0.0]
[main_keras.py::data_generator] Ratio/Padding: [0.0, 0.0]
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.21851003 0.06760221 0.14786571 0.13520442]]

--- [main_keras.py::data_generator] DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::data_generator] Sample shape: (128, 256, 3)
[main_keras.py::data_generator] Target shape: (0, 6)
[main_keras.py::data_generator] Shapes from dataset: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::data_generator] Shapes dtype: float32
[main_keras.py::data_generator] Shapes shape: (3, 2)
[main_keras.py::data_generator] Original size: [0.0, 0.0]
[main_keras.py::data_generator] Ratio/Padding: [0.0, 0.0]
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.54631174 0.8449905  0.08704013 0.19173592]]
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.89423084 0.02496874 0.05209041 0.04993748]
 [0.         0.         0.5858913  0.48548496 0.05522037 0.10731074]]
[main_keras.py::data_generator] Batch samples shape: (4, 128, 256, 3)
[main_keras.py::data_generator] Batch targets shape: (4, 6)
[main_keras.py::data_generator] Batch shapes shape: (4, 3, 2)

--- [main_keras.py::train] KERAS BATCH 0 DEBUG ---
[main_keras.py::train] Samples shape: (4, 128, 256, 3)
[main_keras.py::train] Samples dtype: <dtype: 'float32'>
[main_keras.py::train] Samples min/max: 0.000/1.000
[main_keras.py::train] Targets shape: (4, 6)
[main_keras.py::train] Targets dtype: <dtype: 'float32'>
[main_keras.py::train] Number of targets: 4
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.84579694 0.02303711 0.07518029 0.04607422]
 [0.         0.         0.9329976  0.66589606 0.07383877 0.15019971]]
[main_keras.py::train] Shapes: [[[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]]
[main_keras.py::train] Shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
[main_keras.py::train] Shapes dtype: <dtype: 'float32'>
[main_keras.py::train] Shapes shape: (4, 3, 2)
[main_keras.py::train] Batch item 0 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 0 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 0 ratio/padding: [0.0, 0.0]
[main_keras.py::train] Batch item 1 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 1 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 1 ratio/padding: [0.0, 0.0]

--- [main_keras.py::train] KERAS MODEL OUTPUT DEBUG ---
[main_keras.py::train] Output shape: (4, 16, 32, 65)
[main_keras.py::train] Output min/max: -15.304199/8.525579
[main_keras.py::train] Output mean/std: 0.896456/1.333300

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.050806
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.750596, max: 0.044079
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.0440794937312603
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.338631150371583e-10
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 22
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 22.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.03992998227477074
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (22, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (22, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (22, 1), h: (22, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (22, 1), h: (22, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (22, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (22, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (22, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.006303, max: 0.049448
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (22, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (22, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (22, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (22, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.002713, max: 0.044079
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (88, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (88,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (22, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.882986
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.653072
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.287603
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.173802
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.039930
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 22.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.653072
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.287603
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.173802
[utils/util.py::ComputeLoss.__call__] Total loss: 1.114477
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [main_keras.py::train] KERAS LOSS DEBUG ---
[main_keras.py::train] Loss value: 1.114477
[main_keras.py::train] Loss dtype: <dtype: 'float32'>

--- [main_keras.py::train] KERAS BATCH 1 DEBUG ---
[main_keras.py::train] Samples shape: (4, 128, 256, 3)
[main_keras.py::train] Samples dtype: <dtype: 'float32'>
[main_keras.py::train] Samples min/max: 0.000/0.929
[main_keras.py::train] Targets shape: (5, 6)
[main_keras.py::train] Targets dtype: <dtype: 'float32'>
[main_keras.py::train] Number of targets: 5
[main_keras.py::train] Shapes: [[[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]]
[main_keras.py::train] Shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
[main_keras.py::train] Shapes dtype: <dtype: 'float32'>
[main_keras.py::train] Shapes shape: (4, 3, 2)
[main_keras.py::train] Batch item 0 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 0 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 0 ratio/padding: [0.0, 0.0]
[main_keras.py::train] Batch item 1 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 1 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 1 ratio/padding: [0.0, 0.0]

--- [main_keras.py::train] KERAS MODEL OUTPUT DEBUG ---
[main_keras.py::train] Output shape: (4, 16, 32, 65)
[main_keras.py::train] Output min/max: -18.068085/9.296297
[main_keras.py::train] Output mean/std: 0.884494/1.395957

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.053065
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.754312, max: 0.036936
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.036935530602931976
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.6733925836963657e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 23
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 21.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.005135066341608763
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (21, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (21, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (21, 1), h: (21, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (21, 1), h: (21, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (21, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (21, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.022591, max: 0.037990
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (21, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (21, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.016347, max: 0.035870
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (84, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (84,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (21, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 3.016415
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.265700
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.037336
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.022562
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.005135
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 21.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.265700
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.037336
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.022562
[utils/util.py::ComputeLoss.__call__] Total loss: 0.325598
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [main_keras.py::train] KERAS LOSS DEBUG ---
[main_keras.py::train] Loss value: 0.325598
[main_keras.py::train] Loss dtype: <dtype: 'float32'>

--- [main_keras.py::train] KERAS BATCH 2 DEBUG ---
[main_keras.py::train] Samples shape: (4, 128, 256, 3)
[main_keras.py::train] Samples dtype: <dtype: 'float32'>
[main_keras.py::train] Samples min/max: 0.212/0.996
[main_keras.py::train] Targets shape: (4, 6)
[main_keras.py::train] Targets dtype: <dtype: 'float32'>
[main_keras.py::train] Number of targets: 4
[main_keras.py::train] Shapes: [[[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]

 [[0. 0.]
  [0. 0.]
  [0. 0.]]]
[main_keras.py::train] Shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
[main_keras.py::train] Shapes dtype: <dtype: 'float32'>
[main_keras.py::train] Shapes shape: (4, 3, 2)
[main_keras.py::train] Batch item 0 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 0 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 0 ratio/padding: [0.0, 0.0]
[main_keras.py::train] Batch item 1 shapes: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::train] Batch item 1 original size: [0.0, 0.0]
[main_keras.py::train] Batch item 1 ratio/padding: [0.0, 0.0]

--- [main_keras.py::train] KERAS MODEL OUTPUT DEBUG ---
[main_keras.py::train] Output shape: (4, 16, 32, 65)
[main_keras.py::train] Output min/max: -13.607850/5.002227
[main_keras.py::train] Output mean/std: 0.867632/1.512776

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.046392
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.692942, max: 0.038280
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.038280487060546875
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.9389039812866e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 20
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 16.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0071624829433858395
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (16, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (16, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (16, 1), h: (16, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (16, 1), h: (16, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (16, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (16, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.014014, max: 0.041109
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (16, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (16, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.006275, max: 0.038280
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (64, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (64,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (16, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.883150
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.112817
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.051759
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.029895
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.007162
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 16.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.112817
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.051759
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.029895
[utils/util.py::ComputeLoss.__call__] Total loss: 0.194472
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [main_keras.py::train] KERAS LOSS DEBUG ---
[main_keras.py::train] Loss value: 0.194472
[main_keras.py::train] Loss dtype: <dtype: 'float32'>

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.062765
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.679979, max: 0.058148
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.05814821645617485
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.096851191626172e-10
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 48
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 42.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.06939138472080231
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (42, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (42, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (42, 1), h: (42, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (42, 1), h: (42, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (42, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (42, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (42, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.012086, max: 0.059907
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (42, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (42, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (42, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (42, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.004619, max: 0.058148
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (168, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (168,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (42, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.947883
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.384830
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.492635
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.288375
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.069391
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 42.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.384830
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.492635
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.288375
[utils/util.py::ComputeLoss.__call__] Total loss: 1.165839
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (1, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 1, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 1, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 1, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 1
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 1)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 1, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 1, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 1, 1, 1), h: (4, 1, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.025160
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.682570, max: 0.016203
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.016203397884964943
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 8.89397333992542e-14
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 4
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 1, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 1, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 1, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 1, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 3.0478445296466816e-06
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.015664, max: 0.017127
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.013374, max: 0.016177
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (16, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (16,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (4, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 3.094797
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.032926
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000023
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000014
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000003
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.032926
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000023
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000014
[utils/util.py::ComputeLoss.__call__] Total loss: 0.032963
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.050158
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.711092, max: 0.033534
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.033533725887537
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.009469677987207e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 20
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 19.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.000518510933034122
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (19, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (19, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (19, 1), h: (19, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (19, 1), h: (19, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (19, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (19, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (19, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.015641, max: 0.039468
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (19, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (19, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (19, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (19, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.007559, max: 0.033534
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (76, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (76,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (19, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.887482
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.024433
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.003774
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.002233
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000519
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 19.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.024433
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.003774
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.002233
[utils/util.py::ComputeLoss.__call__] Total loss: 0.030440
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.082065
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.688538, max: 0.068227
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.06822719424962997
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.065444647594063e-10
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 37
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 30.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.07310160249471664
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (30, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (30, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (30, 1), h: (30, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (30, 1), h: (30, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (30, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (30, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (30, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.014160, max: 0.074358
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (30, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (30, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (30, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (30, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.000480, max: 0.065659
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (120, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (120,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (30, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 3.062946
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.425628
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.516771
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.352101
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.073102
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 30.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.425628
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.516771
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.352101
[utils/util.py::ComputeLoss.__call__] Total loss: 1.294501
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (2, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 2
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 2)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 2, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 2, 1, 1), h: (4, 2, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.034277
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.702481, max: 0.029792
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.02979240007698536
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.6990961549122616e-12
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 8
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0002278460015077144
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.019725, max: 0.030855
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.017992, max: 0.029718
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (32, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (32,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (8, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.825608
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.016615
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.001662
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000957
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000228
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.016615
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.001662
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000957
[utils/util.py::ComputeLoss.__call__] Total loss: 0.019234
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.082536
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.692708, max: 0.078199
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.07819896936416626
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 7.711397631560146e-10
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 37
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 31.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.23799553513526917
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (31, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (31, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (31, 1), h: (31, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (31, 1), h: (31, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (31, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (31, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.012281, max: 0.080528
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (31, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (31, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.007547, max: 0.078199
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (124, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (124,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (31, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.795125
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 1.374464
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 1.653023
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.995106
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.237996
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 31.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 1.374464
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 1.653023
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.995106
[utils/util.py::ComputeLoss.__call__] Total loss: 4.022593
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.131404
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.688076, max: 0.119833
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.11983262002468109
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 8.638116888448621e-09
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 66
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 39.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.2001793384552002
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (39, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (39, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (39, 1), h: (39, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (39, 1), h: (39, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (39, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (39, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (39, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.041115, max: 0.122916
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (39, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (39, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (39, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (39, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.030011, max: 0.119833
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (156, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (156,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (39, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 3.039220
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 5.795009
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 6.720157
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 4.369643
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 1.200179
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 39.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 5.795009
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 6.720157
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 4.369643
[utils/util.py::ComputeLoss.__call__] Total loss: 16.884808
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.123543
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.734632, max: 0.074237
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.07423733174800873
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.9047891736123646e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 32
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 31.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.002435904461890459
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (31, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (31, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (31, 1), h: (31, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (31, 1), h: (31, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (31, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (31, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.022897, max: 0.074775
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (31, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (31, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.011663, max: 0.037892
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (124, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (124,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (31, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.904591
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.108986
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.017673
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.010142
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.002436
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 31.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.108986
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.017673
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.010142
[utils/util.py::ComputeLoss.__call__] Total loss: 0.136800
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.051075
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.738611, max: 0.028665
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.028664730489253998
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.82068725216056e-12
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 30.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0008622973109595478
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (30, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (30, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (30, 1), h: (30, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (30, 1), h: (30, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (30, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (30, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (30, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.014613, max: 0.029081
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (30, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (30, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (30, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (30, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.011629, max: 0.028665
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (120, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (120,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (30, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.637370
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.099976
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.006310
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.003382
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000862
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 30.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.099976
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.006310
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.003382
[utils/util.py::ComputeLoss.__call__] Total loss: 0.109669
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.130604
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.707519, max: 0.116936
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.1169361099600792
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.5514496354285257e-09
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 36
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 26.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.5657047629356384
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (26, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (26, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (26, 1), h: (26, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (26, 1), h: (26, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (26, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (26, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (26, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.015373, max: 0.119039
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (26, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (26, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (26, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (26, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.002670, max: 0.116936
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (104, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (104,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (26, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.920681
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 4.106040
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 3.811129
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 2.388245
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.565705
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 26.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 4.106040
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 3.811129
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 2.388245
[utils/util.py::ComputeLoss.__call__] Total loss: 10.305414
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (2, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 2
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 2)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 2, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 2, 1, 1), h: (4, 2, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.200197
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.839841, max: 0.174522
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.1745215803384781
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.436063960611136e-08
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 15
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 15.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.27941206097602844
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (15, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (15, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (15, 1), h: (15, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (15, 1), h: (15, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (15, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (15, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.054592, max: 0.200197
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (15, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (15, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.045176, max: 0.174522
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (60, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (60,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (15, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.837104
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 1.895453
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 1.803870
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 1.220776
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.279412
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 15.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 1.895453
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 1.803870
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 1.220776
[utils/util.py::ComputeLoss.__call__] Total loss: 4.920100
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.087059
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.874880, max: 0.078627
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.07862666249275208
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.346217886639579e-09
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 22
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 20.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.2189355045557022
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (20, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (20, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (20, 1), h: (20, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (20, 1), h: (20, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (20, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (20, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (20, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.010365, max: 0.080961
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (20, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (20, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (20, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (20, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.024792, max: 0.078627
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (80, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (80,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (20, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.475196
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 7.709568
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 1.526103
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.781744
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.218936
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 20.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 7.709568
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 1.526103
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.781744
[utils/util.py::ComputeLoss.__call__] Total loss: 10.017414
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.066484
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.848111, max: 0.062206
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.06220636144280434
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 8.395028422425455e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 40
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 40.0
[utils/util.py::ComputeLoss.assign] Detected anchors assigned to multiple GT boxes
[utils/util.py::ComputeLoss.assign] After resolving multiple assignments - fg_mask sum: 38.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.026208724826574326
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (38, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (38, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (38, 1), h: (38, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (38, 1), h: (38, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (38, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (38, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (38, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.016153, max: 0.063084
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (38, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (38, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (38, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (38, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.010909, max: 0.062206
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (152, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (152,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (38, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.393661
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.171505
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.185526
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.090327
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.026209
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 38.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.171505
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.185526
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.090327
[utils/util.py::ComputeLoss.__call__] Total loss: 0.447358
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.096483
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.870548, max: 0.056238
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.0562378354370594
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 3.2383917596134904e-12
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 29
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 25.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0002663767372723669
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (25, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (25, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (25, 1), h: (25, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (25, 1), h: (25, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (25, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (25, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (25, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.015280, max: 0.053712
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (25, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (25, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (25, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (25, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.004906, max: 0.052145
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (100, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (100,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (25, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.401171
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.003618
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.001941
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000982
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000266
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 25.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.003618
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.001941
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000982
[utils/util.py::ComputeLoss.__call__] Total loss: 0.006541
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.197406
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.884133, max: 0.161757
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.16175684332847595
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.4373552054999266e-10
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 34
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 32.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.08113349229097366
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (32, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (32, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (32, 1), h: (32, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (32, 1), h: (32, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (32, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (32, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.014073, max: 0.106338
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (32, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (32, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.011324, max: 0.090708
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (128, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (128,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (32, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.482004
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.551178
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.559586
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.291628
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.081133
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 32.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.551178
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.559586
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.291628
[utils/util.py::ComputeLoss.__call__] Total loss: 1.402392
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.157465
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.881820, max: 0.142922
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.14292210340499878
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.523512566103946e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 24
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 24.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 8.271330443676561e-05
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (24, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (24, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (24, 1), h: (24, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (24, 1), h: (24, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (24, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (24, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (24, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.014210, max: 0.157465
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (24, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (24, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (24, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (24, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.000120, max: 0.142922
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (96, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (96,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (24, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.210119
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.002899
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000582
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000287
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000083
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 24.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.002899
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000582
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000287
[utils/util.py::ComputeLoss.__call__] Total loss: 0.003768
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.525929
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.866214, max: 0.511995
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.511995255947113
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.101318147789243e-09
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 44
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 17.0
[utils/util.py::ComputeLoss.assign] Detected anchors assigned to multiple GT boxes
[utils/util.py::ComputeLoss.assign] After resolving multiple assignments - fg_mask sum: 15.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.37112244963645935
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (15, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (15, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (15, 1), h: (15, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (15, 1), h: (15, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (15, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (15, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.013517, max: 0.298266
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (15, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (15, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.011113, max: 0.277852
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (60, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (60,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (15, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.378986
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 2.554597
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 2.515541
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 1.381930
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.371122
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 15.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 2.554597
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 2.515541
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 1.381930
[utils/util.py::ComputeLoss.__call__] Total loss: 6.452066
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.354693
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.907033, max: 0.351610
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3516101837158203
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.687158439153905e-10
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 49
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 36.0
[utils/util.py::ComputeLoss.assign] Detected anchors assigned to multiple GT boxes
[utils/util.py::ComputeLoss.assign] After resolving multiple assignments - fg_mask sum: 32.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.15766870975494385
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (32, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (32, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (32, 1), h: (32, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (32, 1), h: (32, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (32, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (32, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.036619, max: 0.198929
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (32, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (32, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.030326, max: 0.186621
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (128, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (128,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (32, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.381851
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 1.403249
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 1.062384
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.615506
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.157669
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 32.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 1.403249
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 1.062384
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.615506
[utils/util.py::ComputeLoss.__call__] Total loss: 3.081139
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.569516
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.839948, max: 0.546154
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5461540222167969
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 3.6080739090893488e-12
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 17.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0009330416796728969
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (17, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (17, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (17, 1), h: (17, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (17, 1), h: (17, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (17, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (17, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (17, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.032428, max: 0.163613
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (17, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (17, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (17, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (17, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.028574, max: 0.143854
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (68, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (68,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (17, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.308583
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.011015
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.006512
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.003477
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000933
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 17.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.011015
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.006512
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.003477
[utils/util.py::ComputeLoss.__call__] Total loss: 0.021004
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.383559
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.917143, max: 0.378396
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.37839609384536743
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 3.696459804913843e-12
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 13
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 3.7707512092310935e-05
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.014270, max: 0.119949
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.002333, max: 0.096460
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (32, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (32,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (8, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.321937
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.001099
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000272
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000136
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000038
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.001099
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000272
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000136
[utils/util.py::ComputeLoss.__call__] Total loss: 0.001507
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.138893
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.921966, max: 0.106310
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.10630961507558823
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.927204749951894e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 31
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 25.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.003076061373576522
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (25, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (25, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (25, 1), h: (25, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (25, 1), h: (25, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (25, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (25, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (25, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.008042, max: 0.087173
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (25, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (25, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (25, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (25, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.000515, max: 0.081316
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (100, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (100,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (25, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.293823
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.020744
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.022083
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.010695
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.003076
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 25.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.020744
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.022083
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.010695
[utils/util.py::ComputeLoss.__call__] Total loss: 0.053522
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.070528
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.883916, max: 0.064244
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.06424418091773987
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 9.652021543127276e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 18
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 16.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.018564123660326004
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (16, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (16, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (16, 1), h: (16, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (16, 1), h: (16, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (16, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (16, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.012414, max: 0.066104
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (16, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (16, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.011091, max: 0.064244
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (64, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (64,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (16, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.496874
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.113623
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.132068
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.071540
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.018564
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 16.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.113623
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.132068
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.071540
[utils/util.py::ComputeLoss.__call__] Total loss: 0.317231
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.071028
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.916916, max: 0.064446
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.06444578617811203
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.73479258736009e-10
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 32
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 32.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.09911204874515533
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (32, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (32, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (32, 1), h: (32, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (32, 1), h: (32, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (32, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (32, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.017772, max: 0.071028
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (32, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (32, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.014613, max: 0.064446
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (128, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (128,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (32, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.389384
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.580416
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.701122
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.339535
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.099112
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 32.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.580416
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.701122
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.339535
[utils/util.py::ComputeLoss.__call__] Total loss: 1.621073
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.314897
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.897786, max: 0.277734
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2777335047721863
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 5.5632680684425395e-09
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 37
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 27.0
[utils/util.py::ComputeLoss.assign] Detected anchors assigned to multiple GT boxes
[utils/util.py::ComputeLoss.assign] After resolving multiple assignments - fg_mask sum: 26.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.7272382974624634
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (26, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (26, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (26, 1), h: (26, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (26, 1), h: (26, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (26, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (26, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (26, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.017320, max: 0.113580
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (26, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (26, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (26, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (26, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.015246, max: 0.112343
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (104, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (104,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (26, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.255714
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 4.281055
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 4.873283
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 2.403137
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.727238
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 26.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 4.281055
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 4.873283
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 2.403137
[utils/util.py::ComputeLoss.__call__] Total loss: 11.557476
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.420890
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.906414, max: 0.381793
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3817931115627289
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.877374700143264e-08
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 47
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 39.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.0610437393188477
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (39, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (39, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (39, 1), h: (39, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (39, 1), h: (39, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (39, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (39, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (39, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.053268, max: 0.310697
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (39, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (39, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (39, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (39, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.045235, max: 0.310254
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (156, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (156,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (39, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.107135
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 6.263449
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 6.475778
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 3.627801
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 1.061044
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 39.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 6.263449
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 6.475778
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 3.627801
[utils/util.py::ComputeLoss.__call__] Total loss: 16.367027
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.358192
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.919391, max: 0.348777
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.348777174949646
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.7431320059255184e-12
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 10.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.8330671309740865e-06
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (10, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (10, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (10, 1), h: (10, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (10, 1), h: (10, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (10, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (10, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.021187, max: 0.101032
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (10, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (10, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.017515, max: 0.100371
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (40, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (40,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (10, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.118740
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.009685
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000013
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000006
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000002
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 10.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.009685
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000013
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000006
[utils/util.py::ComputeLoss.__call__] Total loss: 0.009705
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.594169
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.900737, max: 0.578792
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5787916779518127
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.4492317568226554e-08
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 44
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 10.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.001796442549675703
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (10, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (10, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (10, 1), h: (10, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (10, 1), h: (10, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (10, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (10, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.093796, max: 0.172333
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (10, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (10, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.089740, max: 0.168849
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (40, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (40,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (10, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.228182
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.037686
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.011649
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.006101
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.001796
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 10.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.037686
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.011649
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.006101
[utils/util.py::ComputeLoss.__call__] Total loss: 0.055435
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.615357
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.921055, max: 0.602381
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.6023809909820557
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.7470595282953472e-12
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 27
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 3.1853787731961347e-06
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.019217, max: 0.099161
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.015490, max: 0.090630
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (32, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (32,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (8, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.163218
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.018580
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000023
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000011
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000003
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.018580
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000023
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000011
[utils/util.py::ComputeLoss.__call__] Total loss: 0.018614
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.127660
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.915162, max: 0.124872
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.12487200647592545
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.6398042923526646e-09
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 23
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 23.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.19759595394134521
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (23, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (23, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (23, 1), h: (23, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (23, 1), h: (23, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (23, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (23, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (23, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.026884, max: 0.126336
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (23, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (23, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (23, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (23, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.025015, max: 0.124872
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (92, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (92,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (23, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.073208
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.991488
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 1.372496
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.632505
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.197596
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 23.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.991488
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 1.372496
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.632505
[utils/util.py::ComputeLoss.__call__] Total loss: 2.996489
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.813835
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.899838, max: 0.811170
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.8111695647239685
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.158675148355993e-11
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 65
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 10.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.002449068007990718
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (10, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (10, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (10, 1), h: (10, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (10, 1), h: (10, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (10, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (10, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.022219, max: 0.259359
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (10, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (10, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.001392, max: 0.247518
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (40, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (40,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (10, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.136555
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.081699
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.016734
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.008771
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.002449
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 10.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.081699
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.016734
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.008771
[utils/util.py::ComputeLoss.__call__] Total loss: 0.107204
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.566358
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.920095, max: 0.559718
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5597184896469116
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 5.0668290896283e-06
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 35
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 31.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.9701633453369141
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (31, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (31, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (31, 1), h: (31, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (31, 1), h: (31, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (31, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (31, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.031049, max: 0.264418
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (31, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (31, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.015058, max: 0.259130
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (124, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (124,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (31, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.906654
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 4.412116
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 6.067563
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 2.663176
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.970163
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 31.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 4.412116
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 6.067563
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 2.663176
[utils/util.py::ComputeLoss.__call__] Total loss: 13.142855
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.367085
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.919925, max: 0.334814
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.334814190864563
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 8.897077918845753e-07
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 39
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 33.0
[utils/util.py::ComputeLoss.assign] Detected anchors assigned to multiple GT boxes
[utils/util.py::ComputeLoss.assign] After resolving multiple assignments - fg_mask sum: 32.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.3238866329193115
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (32, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (32, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (32, 1), h: (32, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (32, 1), h: (32, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (32, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (32, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.038389, max: 0.214654
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (32, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (32, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (32, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.029906, max: 0.211691
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (128, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (128,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (32, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.782253
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 4.745950
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 6.470092
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 2.342989
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 1.323887
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 32.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 4.745950
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 6.470092
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 2.342989
[utils/util.py::ComputeLoss.__call__] Total loss: 13.559031
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.559245
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.933983, max: 0.542052
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5420519709587097
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0005617077695205808
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 21
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 21.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 3.1953001022338867
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (21, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (21, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (21, 1), h: (21, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (21, 1), h: (21, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (21, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (21, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.109837, max: 0.559245
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (21, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (21, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.075711, max: 0.542052
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (84, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (84,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (21, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.630712
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 3.921506
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 4.303619
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 1.971536
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 3.195300
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 21.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 3.921506
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 4.303619
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 1.971536
[utils/util.py::ComputeLoss.__call__] Total loss: 10.196661
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.495320
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.993227, max: 0.490599
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4905991852283478
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 3.1548363494948717e-06
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 47
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 31.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.3089195489883423
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (31, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (31, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (31, 1), h: (31, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (31, 1), h: (31, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (31, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (31, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.009897, max: 0.264669
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (31, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (31, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (31, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.000295, max: 0.237484
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (124, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (124,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (31, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.042978
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 5.942640
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 1.902525
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.987443
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.308920
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 31.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 5.942640
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 1.902525
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.987443
[utils/util.py::ComputeLoss.__call__] Total loss: 8.832609
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.527815
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.020990, max: 0.519457
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5194568634033203
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 7.939454054393208e-18
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 21
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 2.8128111293743195e-16
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.031554, max: 0.053853
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.027613, max: 0.047382
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (16, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (16,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (4, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.965106
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.446909
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.108454, max: 0.422822
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.422821968793869
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 5.591912839329513e-20
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 33
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.0024015580263612e-13
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.069405, max: 0.088520
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.060025, max: 0.076583
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (32, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (32,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (8, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.947975
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.157376
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.083413, max: 0.099221
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.09922084957361221
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 6.028610591114061e-18
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 26
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 21.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.218543155268037e-09
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (21, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (21, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (21, 1), h: (21, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (21, 1), h: (21, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (21, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (21, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.025055, max: 0.106176
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (21, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (21, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (21, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.016543, max: 0.099221
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (84, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (84,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (21, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.119029
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 21.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.302409
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.080946, max: 0.282867
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.28286656737327576
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.7769976990238536e-23
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 23
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.8382982412505893e-15
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.021911, max: 0.133161
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.018011, max: 0.122333
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (12, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (12,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (3, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.189265
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.300484
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.070052, max: 0.279963
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.27996310591697693
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.6209526285885255e-20
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 14
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 5.291602225843128e-12
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.067065, max: 0.157411
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.049411, max: 0.148371
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (32, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (32,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (8, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.262336
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.233011
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.064895, max: 0.199671
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.19967129826545715
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.7477541906782967e-29
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 14
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 2.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (2, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (2, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (2, 1), h: (2, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (2, 1), h: (2, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (2, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (2, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (2, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.113153, max: 0.113718
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (2, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (2, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (2, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (2, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.092525, max: 0.102406
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (8, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (8,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (2, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.408983
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 2.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---

[nets/tinysimov35_keras.initialize_biases] Box bias initialized
[nets/tinysimov35_keras.initialize_biases] Cls bias initialized
[nets/tinysimov35_keras.YOLO.__init__] Box bias mean: 1.0
[nets/tinysimov35_keras.YOLO.__init__] Cls bias mean: -7.15461540222168
[nets/tinysimov35_keras.YOLO.__init__] Initial logits min/max: 0.0000/252.0000

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 2) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 3) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 4) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (4, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (4, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
Precision: nan, Recall: nan, mAP50: nan, mAP: nan

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 2) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 3) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 4) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1

=== DEBUG: visualize_predictions input shapes (vis_count=0) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.322/0.749
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[ 0.        0.       18.       17.31     24.       23.380001]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=1) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.341/0.761
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       245.35      19.5       21.289993  23.      ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=2) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.396/0.792
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       127.97      43.38      26.070007  27.54    ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=3) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.227/0.800
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       243.62      25.5       22.440002  23.      ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=4) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.027/0.749
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       235.        44.67      20.669998  21.330002]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (1, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (1, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
Precision: nan, Recall: nan, mAP50: nan, mAP: nan

--- [main_keras.py::data_generator] DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::data_generator] Sample shape: (128, 256, 3)
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Shapes from dataset: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::data_generator] Shapes dtype: float32
[main_keras.py::data_generator] Shapes shape: (3, 2)
[main_keras.py::data_generator] Original size: [0.0, 0.0]
[main_keras.py::data_generator] Ratio/Padding: [0.0, 0.0]
[main_keras.py::data_generator] Target shape: (1, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.06023445 0.42857826 0.09683812 0.20318535]]

--- [main_keras.py::data_generator] DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::data_generator] Sample shape: (128, 256, 3)
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Shapes from dataset: [[0. 0.]
 [0. 0.]
 [0. 0.]]
[main_keras.py::data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::data_generator] Shapes dtype: float32
[main_keras.py::data_generator] Shapes shape: (3, 2)
[main_keras.py::data_generator] Original size: [0.0, 0.0]
[main_keras.py::data_generator] Ratio/Padding: [0.0, 0.0]
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.9861675  0.11709949 0.02766497 0.23419899]
 [0.         0.         0.4796456  0.13912599 0.11329541 0.23240069]]
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.86145276 0.7918634  0.08328465 0.16833961]
 [0.         0.         0.65674144 0.52157044 0.08964163 0.16866142]]
[main_keras.py::data_generator] Target shape: (3, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.88474774 0.2511298  0.05097049 0.09786335]
 [0.         0.         0.3472334  0.2163883  0.04542488 0.08546731]
 [0.         0.         0.7534886  0.7506405  0.04532294 0.09378564]]
[main_keras.py::data_generator] Batch samples shape: (4, 128, 256, 3)
[main_keras.py::data_generator] Batch targets shape: (8, 6)
[main_keras.py::data_generator] Batch shapes shape: (4, 3, 2)
[main_keras.py::data_generator] Target shape: (2, 6)
[main_keras.py::data_generator] Target sample: [[0.         0.         0.02908153 0.23822922 0.05816305 0.1834947 ]
 [0.         0.         0.9704841  0.45610923 0.05902398 0.18844107]]

--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.443573
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.103597, max: 0.433005
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.43300485610961914
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 3.852327446632996e-23
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 50
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 11.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 6.404861653520021e-15
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (11, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (11, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (11, 1), h: (11, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (11, 1), h: (11, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (11, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (11, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (11, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.083067, max: 0.098924
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (11, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (11, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (11, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (11, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.055128, max: 0.087089
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (44, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (44,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (11, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.021403
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 11.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.588123
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.989636, max: 0.571017
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5710171461105347
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.464011490564657e-19
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 61
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.1436685626309284e-10
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.071589, max: 0.294108
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.062563, max: 0.256184
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (12, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (12,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (3, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.961892
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.655590
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.087391, max: 0.652553
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.6525532603263855
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 7.224263466882129e-21
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 46
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 10.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 3.158828667387814e-12
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (10, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (10, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (10, 1), h: (10, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (10, 1), h: (10, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (10, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (10, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.024285, max: 0.290550
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (10, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (10, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (10, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.012894, max: 0.287721
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (40, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (40,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (10, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.970264
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 10.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.477206
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.926443, max: 0.462688
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4626883268356323
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.1595034781156316e-22
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 25
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 5.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 2.3299883733957387e-15
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (5, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (5, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (5, 1), h: (5, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (5, 1), h: (5, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (5, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (5, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (5, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.068336, max: 0.138081
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (5, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (5, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (5, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (5, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.038557, max: 0.134858
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (20, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (20,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (5, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.319373
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 5.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.497838
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.091553, max: 0.454238
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.45423778891563416
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 26
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.066925, max: 0.066925
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.049422, max: 0.049422
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.541333
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.681242
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.959775, max: 0.680050
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.6800503134727478
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.532480164031014e-25
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 52
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.5627895188823525e-17
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.071708, max: 0.071708
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.061710, max: 0.061710
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.769160
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.384265
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.104217, max: 0.373596
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3735963702201843
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.2104261217527257e-23
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 35
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 2.9626410007040096e-17
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.059695, max: 0.116796
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.051187, max: 0.100198
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (12, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (12,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (3, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.803051
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.593883
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.067371, max: 0.585492
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5854916572570801
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 50
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.450236
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.991435, max: 0.419162
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4191618859767914
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 60
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.097950, max: 0.187169
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.015332, max: 0.128155
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (12, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (12,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (3, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 3.471647
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.525584
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.897355, max: 0.507978
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5079779624938965
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.447709
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.004237, max: 0.419624
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.41962429881095886
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 28
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.507963
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.978624, max: 0.493821
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4938212037086487
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.179025, max: 0.179025
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.082868, max: 0.082868
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.839134
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.171009
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.099825, max: 0.164178
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.16417765617370605
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 3.4891475610106396e-25
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 10
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 5.0
[utils/util.py::ComputeLoss.assign] Detected anchors assigned to multiple GT boxes
[utils/util.py::ComputeLoss.assign] After resolving multiple assignments - fg_mask sum: 4.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 2.99096333400558e-17
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.040468, max: 0.058665
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.038393, max: 0.049320
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (16, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (16,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (4, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.946066
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.433644
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.036137, max: 0.404878
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4048784375190735
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 8.752601625402456e-21
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 48
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 7.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 2.3350904543306683e-12
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (7, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (7, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (7, 1), h: (7, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (7, 1), h: (7, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (7, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (7, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (7, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.011506, max: 0.151185
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (7, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (7, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (7, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (7, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.005979, max: 0.136837
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (28, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (28,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (7, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.919032
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 7.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (2, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 2, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 2
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 2)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 2, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 2, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 2, 1, 1), h: (4, 2, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.153081
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 2, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.075925, max: 0.139563
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.13956299424171448
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.2673198349394866e-30
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 6
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 2, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 2, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.389003
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.058986, max: 0.360977
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3609773516654968
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 54
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.602764
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.085359, max: 0.586801
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5868009924888611
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.1624748962645456e-24
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 2.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 6.428525631221112e-25
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (2, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (2, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (2, 1), h: (2, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (2, 1), h: (2, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (2, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (2, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (2, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.021502, max: 0.021692
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (2, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (2, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (2, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (2, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.004781, max: 0.007535
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (8, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (8,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (2, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.064594
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 2.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.687581
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.927722, max: 0.682825
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.6828253865242004
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 2.0668822858923245e-26
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 62
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.52290382100275e-18
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.093407, max: 0.093407
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.073681, max: 0.073681
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.920988
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.758355
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.911816, max: 0.754954
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.7549542188644409
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.0095840292244434e-17
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 56
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 18.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 3.130723458255602e-09
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (18, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (18, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (18, 1), h: (18, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (18, 1), h: (18, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (18, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (18, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (18, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.043741, max: 0.297319
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (18, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (18, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (18, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (18, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.063119, max: 0.294630
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (72, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (72,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (18, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.619907
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 18.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.598590
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.002526, max: 0.588628
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5886284112930298
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.41216280810581e-21
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 40
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 9.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 6.092421489176103e-13
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (9, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (9, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (9, 1), h: (9, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (9, 1), h: (9, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (9, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (9, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.062628, max: 0.170312
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (9, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (9, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (9, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.061961, max: 0.149982
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (36, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (36,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (9, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.909318
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 9.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.361643
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.039945, max: 0.340814
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.34081384539604187
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 8.031877299759799e-22
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 35
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 13.0
[utils/util.py::ComputeLoss.assign] Detected anchors assigned to multiple GT boxes
[utils/util.py::ComputeLoss.assign] After resolving multiple assignments - fg_mask sum: 12.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 8.752897630867965e-14
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (12, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (12, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (12, 1), h: (12, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (12, 1), h: (12, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (12, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (12, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (12, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.039560, max: 0.361643
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (12, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (12, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (12, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (12, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.033535, max: 0.340814
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (48, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (48,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (12, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.016337
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 12.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.605226
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.891881, max: 0.602415
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.6024154424667358
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 28
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.507293
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.037976, max: 0.494801
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.49480146169662476
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 6
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.365146
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.097516, max: 0.308298
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.30829837918281555
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 33
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.054668, max: 0.054668
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.001339, max: -0.001339
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 4.217924
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.296539
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.924041, max: 0.277194
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.2771936357021332
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.570305
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.901381, max: 0.556314
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.556313693523407
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 38
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.416295
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.968683, max: 0.390827
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3908268213272095
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 20
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (3, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (3, 1), h: (3, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.080606, max: 0.171896
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (3, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (3, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.058047, max: 0.160486
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (12, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (12,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (3, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.133933
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 3.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (7, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 7, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 7
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 7)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 7, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 7, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 7, 1, 1), h: (4, 7, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.730133
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 7, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.903981, max: 0.727421
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.7274208664894104
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.447521138450637e-22
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 63
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 7, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 7, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 7.759807065573637e-14
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1), h: (4, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.194235, max: 0.196705
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.154163, max: 0.189501
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (16, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (16,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (4, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.961540
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 4.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.514466
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.964445, max: 0.491600
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4915998876094818
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.0627934982695068e-21
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 43
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 18.0
[utils/util.py::ComputeLoss.assign] Detected anchors assigned to multiple GT boxes
[utils/util.py::ComputeLoss.assign] After resolving multiple assignments - fg_mask sum: 15.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 5.905571170972124e-13
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (15, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (15, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (15, 1), h: (15, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (15, 1), h: (15, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (15, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (15, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.077766, max: 0.252719
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (15, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (15, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (15, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.049867, max: 0.227315
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (60, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (60,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (15, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.946349
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 15.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (6, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 6, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 6
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 6)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 6, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 6, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 6, 1, 1), h: (4, 6, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.498517
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 6, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.075799, max: 0.453035
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.45303475856781006
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 30
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 6, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 6, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (9, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 9, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 9
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 9)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 9, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 9, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 9, 1, 1), h: (4, 9, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.279164
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 9, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.904349, max: 0.264509
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.26450884342193604
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 23
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 9, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 9, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (10, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 10, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 10, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 10, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 10
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 10)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 10, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 10, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 10, 1, 1), h: (4, 10, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.266529
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 10, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.979552, max: 0.223034
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.22303445637226105
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 34
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 10, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 10, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 10, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 10, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.159852
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.042923, max: 0.138397
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.13839685916900635
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.7321697310779198e-30
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 25
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (5, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 5, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 5
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 5)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 5, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 5, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 5, 1, 1), h: (4, 5, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.363016
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 5, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.078716, max: 0.316105
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.31610503792762756
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 24
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 5, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 5, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.332068
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.998010, max: 0.306422
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3064216077327728
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 4.328369161531686e-26
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 19
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 2.263063378753974e-18
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.073100, max: 0.073100
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.052284, max: 0.052284
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.264384
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.573773
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.076313, max: 0.558813
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5588128566741943
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 42
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.394047
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.128376, max: 0.387856
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3878559172153473
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.4863011305960668e-19
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 32
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 2.1287936962256088e-15
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (8, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (8, 1), h: (8, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.019990, max: 0.143127
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (8, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (8, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.002480, max: 0.119183
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (32, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (32,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (8, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 2.175705
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 8.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.540330
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.079571, max: 0.536201
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.5362005233764648
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 24
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (11, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 11, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 11, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 11, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 11
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 11)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 11, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 11, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 11, 1, 1), h: (4, 11, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 11, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 11, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 11, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.497608
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 11, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 11, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 11, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 11, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.021591, max: 0.496754
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 11, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.49675410985946655
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 11, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 11, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 40
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 11, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 11, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 11, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 11, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 11, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 11, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 11, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.325542
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.946773, max: 0.319824
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3198237419128418
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 0.0
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 29
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (8, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 8, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 8
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 8)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 8, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 8, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 8, 1, 1), h: (4, 8, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.410126
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 8, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.977912, max: 0.395038
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.3950384855270386
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.781178482015062e-19
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 59
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 8, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 8, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 16.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 4.9972057741820564e-11
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (16, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (16, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (16, 1), h: (16, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (16, 1), h: (16, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (16, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (16, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.032869, max: 0.263371
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (16, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (16, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (16, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.029423, max: 0.252302
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (64, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (64,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (16, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.859046
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 16.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (3, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 3, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 3
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 3)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 3, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 3, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 3, 1, 1), h: (4, 3, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.204837
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 3, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -0.925172, max: 0.134162
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.13416191935539246
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.9207839799464547e-28
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 10
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 3, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 3, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 0.0
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 0.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] KERAS LOSS COMPUTATION DEBUG ---
[utils/util.py::ComputeLoss.__call__] Number of output tensors: 1
[utils/util.py::ComputeLoss.__call__] Output 0 shape: (4, 16, 32, 65)
[utils/util.py::ComputeLoss.__call__] Concatenated output shape: (4, 65, 512)
[utils/util.py::ComputeLoss.__call__] pred_output shape: (4, 64, 512)
[utils/util.py::ComputeLoss.__call__] pred_scores shape: (4, 1, 512)
[utils/util.py::ComputeLoss.__call__] After permute - pred_output shape: (4, 512, 64)
[utils/util.py::ComputeLoss.__call__] After permute - pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Size tensor: [128. 256.]
[utils/util.py::ComputeLoss.__call__] Anchor points shape: (512, 2)
[utils/util.py::ComputeLoss.__call__] Stride tensor shape: (512, 1)

--- [utils/util.py::ComputeLoss.__call__] TARGET PROCESSING ---
[utils/util.py::ComputeLoss.__call__] Targets shape: (4, 6)
[utils/util.py::ComputeLoss.__call__] Pred output dimensions - b: 4, a: 512, c: 64
[utils/util.py::ComputeLoss.__call__] Pred bboxes after softmax shape: (4, 512, 4, 16)
[utils/util.py::ComputeLoss.__call__] Pred bboxes after matmul shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Final pred bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.__call__] Scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.__call__] Bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.__call__] ASSIGNMENT PHASE ---

--- [utils/util.py::ComputeLoss.assign] KERAS ASSIGNMENT DEBUG ---
[utils/util.py::ComputeLoss.assign] pred_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)
[utils/util.py::ComputeLoss.assign] true_labels shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils.util.py::ComputeLoss.assign] true_mask shape: (4, 4, 1)
[utils/util.py::ComputeLoss.assign] anchors shape: (512, 2)
[utils/util.py::ComputeLoss.assign] Batch size: 4, Max boxes: 4
[utils/util.py::ComputeLoss.assign] Created indices tensor with shape: (2, 4, 4)

--- [utils/util.py::ComputeLoss.assign] IOUs DEBUG ---
[utils/util.py::ComputeLoss.assign] true_bboxes shape: (4, 4, 4)
[utils/util.py::ComputeLoss.assign] pred_bboxes shape: (4, 512, 4)

--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (4, 4, 1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (4, 1, 512, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (4, 4, 1, 1), h: (4, 4, 1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (4, 1, 512, 1), h: (4, 1, 512, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.000000, max: 0.484918
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (4, 4, 512, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: -1.004833, max: 0.474130
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---

[utils/util.py::ComputeLoss.assign] overlaps shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] overlaps min: 0.0, max: 0.4741303026676178
[utils/util.py::ComputeLoss.assign] align_metric shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] align_metric min: 0.0, max: 1.3722867521119809e-24
[utils/util.py::ComputeLoss.assign] mask_in_gts shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_in_gts sum: 43
[utils/util.py::ComputeLoss.assign] metrics shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] top_k_mask shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_metrics shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] top_k_indices shape: (4, 4, 10)
[utils/util.py::ComputeLoss.assign] is_in_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_top_k shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] mask_pos shape: (4, 4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask shape: (4, 512)
[utils/util.py::ComputeLoss.assign] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.assign] target_gt_idx shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_labels shape: (4, 512)
[utils/util.py::ComputeLoss.assign] target_bboxes shape: (4, 512, 4)
[utils/util_keras.py::ComputeLoss.assign] self.nc: 1
[utils/util_keras.py::ComputeLoss.assign] target_scores shape: (4, 512, 1)
[utils/util_keras.py::ComputeLoss.assign] Normalized target_scores shape: (4, 512, 1)
[utils/util.py::ComputeLoss.assign] target_scores sum: 1.7355155841313879e-16
--- [utils/util.py::ComputeLoss.assign] END KERAS ASSIGNMENT DEBUG ---


--- [utils/util.py::ComputeLoss.iou] KERAS IOU DEBUG ---
[utils/util.py::ComputeLoss.iou] box1 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] box2 shape: (1, 4)
[utils/util.py::ComputeLoss.iou] Box1 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Box2 dimensions - w: (1, 1), h: (1, 1)
[utils/util.py::ComputeLoss.iou] Intersection shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Union shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] IoU min: 0.131397, max: 0.131397
[utils/util.py::ComputeLoss.iou] Convex diagonal squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Center distance squared shape: (1, 1)
[utils/util.py::ComputeLoss.iou] Aspect ratio term shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU shape: (1, 1)
[utils/util.py::ComputeLoss.iou] CIoU min: 0.126469, max: 0.126469
--- [utils/util.py::ComputeLoss.iou] END KERAS IOU DEBUG ---


--- [utils/util_keras.py::ComputeLoss.df_loss] KERAS DFL LOSS DEBUG ---
[utils/util_keras.py::ComputeLoss.df_loss] pred_dist shape: (4, 16), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] target shape: (4,), dtype: <dtype: 'float32'>
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss shape: (1, 1)
[utils/util_keras.py::ComputeLoss.df_loss] DFL loss mean: 1.887368
--- [utils/util_keras.py::ComputeLoss.df_loss] END KERAS DFL LOSS DEBUG ---


--- [utils/util.py::ComputeLoss.__call__] LOSS COMPONENTS DEBUG ---
[utils/util.py::ComputeLoss.__call__] Raw loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Raw loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Loss weights - cls: 0.5, box: 7.5, dfl: 1.5
[utils/util.py::ComputeLoss.__call__] target_scores_sum: 0.000000
[utils/util.py::ComputeLoss.__call__] fg_mask sum: 1.0
[utils/util.py::ComputeLoss.__call__] Weighted loss_cls: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_box: 0.000000
[utils/util.py::ComputeLoss.__call__] Weighted loss_dfl: 0.000000
[utils/util.py::ComputeLoss.__call__] Total loss: 0.000000
--- [utils/util.py::ComputeLoss.__call__] END KERAS LOSS COMPUTATION DEBUG ---

[nets/tinysimov35_keras.initialize_biases] Box bias initialized
[nets/tinysimov35_keras.initialize_biases] Cls bias initialized
[nets/tinysimov35_keras.YOLO.__init__] Box bias mean: 1.0
[nets/tinysimov35_keras.YOLO.__init__] Cls bias mean: -7.15461540222168
[nets/tinysimov35_keras.YOLO.__init__] Initial logits min/max: 0.0000/252.0000

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 2) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 3) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 4) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (4, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (4, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
Precision: nan, Recall: nan, mAP50: nan, mAP: nan

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 0) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 1) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 2) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 3) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0

--- [main_keras.py::test_data_generator] TEST DATASET OUTPUT DEBUG (sample 4) ---
[main_keras.py::test_data_generator] Sample shape: (128, 256, 3)
[main_keras.py::test_data_generator] Target shape: (1, 6)
[main_keras.py::test_data_generator] Shapes from dataset: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
[main_keras.py::test_data_generator] Shapes type: <class 'numpy.ndarray'>
[main_keras.py::test_data_generator] Shapes dtype: float32
[main_keras.py::test_data_generator] Shapes shape: (3, 2)
[main_keras.py::test_data_generator] Original size: [128.0, 256.0]
[main_keras.py::test_data_generator] Ratio/Padding: [1.0, 1.0]
[main_keras.py::test_data_generator] Padded target shape: (100, 6)
[main_keras.py::test_data_generator] Non-zero targets: 0
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1

=== DEBUG: visualize_predictions input shapes (vis_count=0) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.322/0.749
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[ 0.        0.       18.       17.31     24.       23.380001]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=1) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.341/0.761
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       245.35      19.5       21.289993  23.      ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=2) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.396/0.792
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       127.97      43.38      26.070007  27.54    ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=3) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.227/0.800
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       243.62      25.5       22.440002  23.      ]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===

=== DEBUG: visualize_predictions input shapes (vis_count=4) ===
single_sample shape: (1, 128, 256, 3)
single_sample dtype: <dtype: 'float32'>
single_sample min/max: 0.027/0.749
single_out type: <class 'list'>
single_out length: 1
single_out[0] shape: (0, 6)
single_out[0] dtype: <dtype: 'float32'>
single_out[0]: empty tensor
single_gt shape: (1, 6)
single_gt dtype: <dtype: 'float32'>
single_gt content (first few):
tf.Tensor([[  0.         0.       235.        44.67      20.669998  21.330002]], shape=(1, 6), dtype=float32)
single_shapes: [[[128. 256.]
  [  1.   1.]
  [  0.   0.]]]
shapes shape: (8, 3, 2)
single_shapes type: <class 'tensorflow.python.framework.ops.EagerTensor'>
single_shapes dtype: <dtype: 'float32'>
single_shapes shape: (1, 3, 2)
single_shapes[0]: [[128. 256.]
 [  1.   1.]
 [  0.   0.]]
single_shapes[0] original size: [128.0, 256.0]
single_shapes[0] ratio/padding: [1.0, 1.0]
=== END DEBUG ===
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (8, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (8, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
[main_keras.py::test] Model outputs shape: (1, 512, 5)

--- [utils/util_keras.py::non_max_suppression] KERAS NMS DEBUG ---
[utils/util_keras.py::non_max_suppression] Prediction shape: (1, 512, 5)
[utils/util_keras.py::non_max_suppression] Conf threshold: 0.25, IoU threshold: 0.45
[utils/util_keras.py::non_max_suppression] Number of classes: 1
Precision: nan, Recall: nan, mAP50: nan, mAP: nan
